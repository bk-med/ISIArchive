{"level":"info","message":"üìö Swagger documentation available at: http://localhost:5001/api/docs","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"‚úÖ Database connected successfully","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"Redis Client Connected","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"Redis Client Ready","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"Successfully connected to Redis","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"‚úÖ Redis connected successfully","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"Email service initialized","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"‚úÖ Email service initialized","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"üöÄ ISI Archive API started successfully","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"üìç Server running on port 5001","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"üåç Environment: development","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"üìö API Documentation: http://localhost:5001/api/docs","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"üíö Health Check: http://localhost:5001/api/health","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"üìã API Info: http://localhost:5001/api","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"info","message":"üîß Development mode - detailed logging enabled","service":"isi-archive-api","timestamp":"2025-06-04 11:11:09"}
{"level":"error","message":"Authentication error: Access token expired","service":"isi-archive-api","stack":"Error: Access token expired\n    at verifyAccessToken (/app/src/utils/jwt.ts:52:13)\n    at authenticate (/app/src/middleware/auth.ts:29:38)\n    at newFn (/app/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5)\n    at next (/app/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/app/node_modules/express/lib/router/route.js:119:3)\n    at newFn (/app/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5)\n    at /app/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/app/node_modules/express/lib/router/index.js:346:12)","timestamp":"2025-06-04 11:12:15"}
{"level":"error","message":"Authentication error: Access token expired","service":"isi-archive-api","stack":"Error: Access token expired\n    at verifyAccessToken (/app/src/utils/jwt.ts:52:13)\n    at authenticate (/app/src/middleware/auth.ts:29:38)\n    at newFn (/app/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5)\n    at next (/app/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/app/node_modules/express/lib/router/route.js:119:3)\n    at newFn (/app/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5)\n    at /app/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/app/node_modules/express/lib/router/index.js:346:12)","timestamp":"2025-06-04 11:12:15"}
{"level":"warn","message":"Failed token refresh attempt: Token de rafra√Æchissement invalide","service":"isi-archive-api","stack":"Error: Token de rafra√Æchissement invalide\n    at Function.refreshToken (/app/src/services/authService.ts:194:15)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async refreshToken (/app/src/controllers/authController.ts:125:22)","timestamp":"2025-06-04 11:12:16"}
{"level":"error","message":"Token refresh error: Token de rafra√Æchissement invalide","service":"isi-archive-api","stack":"Error: Token de rafra√Æchissement invalide\n    at Function.refreshToken (/app/src/services/authService.ts:235:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async refreshToken (/app/src/controllers/authController.ts:125:22)","timestamp":"2025-06-04 11:12:16"}
{"level":"warn","message":"Failed token refresh attempt: Token de rafra√Æchissement invalide","service":"isi-archive-api","stack":"Error: Token de rafra√Æchissement invalide\n    at Function.refreshToken (/app/src/services/authService.ts:194:15)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async refreshToken (/app/src/controllers/authController.ts:125:22)","timestamp":"2025-06-04 11:12:16"}
{"level":"error","message":"Token refresh error: Token de rafra√Æchissement invalide","service":"isi-archive-api","stack":"Error: Token de rafra√Æchissement invalide\n    at Function.refreshToken (/app/src/services/authService.ts:235:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async refreshToken (/app/src/controllers/authController.ts:125:22)","timestamp":"2025-06-04 11:12:16"}
{"level":"info","message":"Successful login for user: admin@isi.tn","service":"isi-archive-api","timestamp":"2025-06-04 11:12:38"}
{"level":"info","message":"Audit log created: LOGIN by user 2448619c-5425-44e3-8703-30b6b4c38e61","service":"isi-archive-api","timestamp":"2025-06-04 11:12:38"}
{"level":"info","message":"Matiere L1-SE-MAT3 professor assignments updated by user 2448619c-5425-44e3-8703-30b6b4c38e61","service":"isi-archive-api","timestamp":"2025-06-04 11:13:43"}
{"level":"error","message":"Authentication error: Access token expired","service":"isi-archive-api","stack":"Error: Access token expired\n    at verifyAccessToken (/app/src/utils/jwt.ts:52:13)\n    at authenticate (/app/src/middleware/auth.ts:29:38)\n    at newFn (/app/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/app/node_modules/express/lib/router/index.js:328:13)\n    at /app/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/app/node_modules/express/lib/router/index.js:346:12)\n    at next (/app/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/app/node_modules/express/lib/router/index.js:175:3)\n    at router (/app/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-06-04 11:40:08"}
{"level":"error","message":"Authentication error: Access token expired","service":"isi-archive-api","stack":"Error: Access token expired\n    at verifyAccessToken (/app/src/utils/jwt.ts:52:13)\n    at authenticate (/app/src/middleware/auth.ts:29:38)\n    at newFn (/app/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/app/node_modules/express/lib/router/index.js:328:13)\n    at /app/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/app/node_modules/express/lib/router/index.js:346:12)\n    at next (/app/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/app/node_modules/express/lib/router/index.js:175:3)\n    at router (/app/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-06-04 11:40:08"}
{"level":"error","message":"Authentication error: Access token expired","service":"isi-archive-api","stack":"Error: Access token expired\n    at verifyAccessToken (/app/src/utils/jwt.ts:52:13)\n    at authenticate (/app/src/middleware/auth.ts:29:38)\n    at newFn (/app/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/app/node_modules/express/lib/router/index.js:328:13)\n    at /app/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/app/node_modules/express/lib/router/index.js:346:12)\n    at next (/app/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/app/node_modules/express/lib/router/index.js:175:3)\n    at router (/app/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-06-04 11:40:08"}
{"level":"error","message":"Authentication error: Access token expired","service":"isi-archive-api","stack":"Error: Access token expired\n    at verifyAccessToken (/app/src/utils/jwt.ts:52:13)\n    at authenticate (/app/src/middleware/auth.ts:29:38)\n    at newFn (/app/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/app/node_modules/express/lib/router/index.js:328:13)\n    at /app/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/app/node_modules/express/lib/router/index.js:346:12)\n    at next (/app/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/app/node_modules/express/lib/router/index.js:175:3)\n    at router (/app/node_modules/express/lib/router/index.js:47:12)","timestamp":"2025-06-04 11:40:08"}
{"level":"info","message":"Token refreshed for user: admin@isi.tn","service":"isi-archive-api","timestamp":"2025-06-04 11:40:08"}
{"level":"info","message":"Token refreshed for user: admin@isi.tn","service":"isi-archive-api","timestamp":"2025-06-04 11:40:08"}
{"level":"info","message":"Token refreshed for user: admin@isi.tn","service":"isi-archive-api","timestamp":"2025-06-04 11:40:08"}
{"level":"warn","message":"Failed token refresh attempt: Token de rafra√Æchissement invalide","service":"isi-archive-api","stack":"Error: Token de rafra√Æchissement invalide\n    at Function.refreshToken (/app/src/services/authService.ts:194:15)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async refreshToken (/app/src/controllers/authController.ts:125:22)","timestamp":"2025-06-04 11:40:08"}
{"level":"error","message":"Token refresh error: Token de rafra√Æchissement invalide","service":"isi-archive-api","stack":"Error: Token de rafra√Æchissement invalide\n    at Function.refreshToken (/app/src/services/authService.ts:235:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async refreshToken (/app/src/controllers/authController.ts:125:22)","timestamp":"2025-06-04 11:40:08"}
{"level":"info","message":"Audit log created: PAGE_ACCESS by user 2448619c-5425-44e3-8703-30b6b4c38e61","service":"isi-archive-api","timestamp":"2025-06-04 11:40:08"}
{"level":"info","message":"Successful login for user: prof.cs@isi.tn","service":"isi-archive-api","timestamp":"2025-06-04 11:43:43"}
{"level":"info","message":"Audit log created: LOGIN by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:43:43"}
{"level":"info","message":"Audit log created: PAGE_ACCESS by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:44:27"}
{"level":"info","message":"Created directory: /app/uploads/documents/L1/Licence en sciences de l'informatique/S1/Algorithmique et Structures de Donn√©es/td","service":"isi-archive-api","timestamp":"2025-06-04 11:45:07"}
{"level":"info","message":"Document created: document cours by user ea344291-4313-4dec-9cc4-6bc8d7f440ec with 3 matiere(s)","service":"isi-archive-api","timestamp":"2025-06-04 11:45:07"}
{"level":"info","message":"Audit log created: DOCUMENT_UPLOAD by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:45:07"}
{"level":"info","message":"Audit log created: PAGE_ACCESS by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:45:08"}
{"level":"info","message":"View count incremented for document afc3095a-7f44-402e-8ba4-93420a450256","service":"isi-archive-api","timestamp":"2025-06-04 11:45:19"}
{"level":"info","message":"Audit log created: DOCUMENT_VIEW by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:45:19"}
{"level":"info","message":"Comment created on document afc3095a-7f44-402e-8ba4-93420a450256 by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:45:51"}
{"level":"info","message":"Document downloaded: document cours by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:46:07"}
{"level":"info","message":"Download count incremented for document afc3095a-7f44-402e-8ba4-93420a450256","service":"isi-archive-api","timestamp":"2025-06-04 11:46:07"}
{"level":"info","message":"Audit log created: DOCUMENT_DOWNLOAD by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:46:07"}
{"level":"info","message":"View count incremented for document afc3095a-7f44-402e-8ba4-93420a450256","service":"isi-archive-api","timestamp":"2025-06-04 11:46:10"}
{"level":"info","message":"Audit log created: DOCUMENT_VIEW by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:46:10"}
{"level":"info","message":"View count increment skipped for document afc3095a-7f44-402e-8ba4-93420a450256 (rate limited)","service":"isi-archive-api","timestamp":"2025-06-04 11:46:14"}
{"level":"info","message":"Audit log created: DOCUMENT_VIEW by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:46:14"}
{"level":"info","message":"View count increment skipped for document afc3095a-7f44-402e-8ba4-93420a450256 (rate limited)","service":"isi-archive-api","timestamp":"2025-06-04 11:46:15"}
{"level":"info","message":"Audit log created: DOCUMENT_VIEW by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:46:15"}
{"level":"info","message":"View count incremented for document afc3095a-7f44-402e-8ba4-93420a450256","service":"isi-archive-api","timestamp":"2025-06-04 11:46:17"}
{"level":"info","message":"Audit log created: DOCUMENT_VIEW by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:46:17"}
{"level":"info","message":"View count increment skipped for document afc3095a-7f44-402e-8ba4-93420a450256 (rate limited)","service":"isi-archive-api","timestamp":"2025-06-04 11:46:19"}
{"level":"info","message":"Audit log created: DOCUMENT_VIEW by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:46:19"}
{"level":"info","message":"Audit log created: PAGE_ACCESS by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:46:27"}
{"level":"info","message":"Created directory: /app/uploads/documents/L1/Licence en sciences de l'informatique/S1/Algorithmique et Structures de Donn√©es/examen","service":"isi-archive-api","timestamp":"2025-06-04 11:47:08"}
{"level":"info","message":"Document created: document c19554 by user ea344291-4313-4dec-9cc4-6bc8d7f440ec with 1 matiere(s)","service":"isi-archive-api","timestamp":"2025-06-04 11:47:08"}
{"level":"info","message":"Audit log created: DOCUMENT_UPLOAD by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:47:08"}
{"level":"info","message":"Audit log created: PAGE_ACCESS by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:47:08"}
{"level":"info","message":"Document deleted: document c19554 by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:47:24"}
{"level":"info","message":"Audit log created: PAGE_ACCESS by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:47:24"}
{"level":"info","message":"Audit log created: PAGE_ACCESS by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:47:26"}
{"level":"info","message":"Audit log created: PAGE_ACCESS by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:47:45"}
{"level":"info","message":"User logged out: ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:47:57"}
{"level":"info","message":"Audit log created: LOGOUT by user ea344291-4313-4dec-9cc4-6bc8d7f440ec","service":"isi-archive-api","timestamp":"2025-06-04 11:47:57"}
{"level":"info","message":"Successful login for user: etudiant.l1@isi.tn","service":"isi-archive-api","timestamp":"2025-06-04 11:48:11"}
{"level":"info","message":"Audit log created: LOGIN by user 6d6185ab-372e-4d9f-b856-fb35d093da76","service":"isi-archive-api","timestamp":"2025-06-04 11:48:11"}
{"level":"info","message":"Audit log created: PAGE_ACCESS by user 6d6185ab-372e-4d9f-b856-fb35d093da76","service":"isi-archive-api","timestamp":"2025-06-04 11:48:31"}
{"level":"info","message":"View count incremented for document afc3095a-7f44-402e-8ba4-93420a450256","service":"isi-archive-api","timestamp":"2025-06-04 11:48:33"}
{"level":"info","message":"Audit log created: DOCUMENT_VIEW by user 6d6185ab-372e-4d9f-b856-fb35d093da76","service":"isi-archive-api","timestamp":"2025-06-04 11:48:33"}
{"level":"info","message":"Comment created on document afc3095a-7f44-402e-8ba4-93420a450256 by user 6d6185ab-372e-4d9f-b856-fb35d093da76","service":"isi-archive-api","timestamp":"2025-06-04 11:48:44"}
{"level":"info","message":"Comment created on document afc3095a-7f44-402e-8ba4-93420a450256 by user 6d6185ab-372e-4d9f-b856-fb35d093da76","service":"isi-archive-api","timestamp":"2025-06-04 11:48:52"}
{"level":"info","message":"Audit log created: PAGE_ACCESS by user 6d6185ab-372e-4d9f-b856-fb35d093da76","service":"isi-archive-api","timestamp":"2025-06-04 11:49:15"}
{"level":"info","message":"User logged out: 6d6185ab-372e-4d9f-b856-fb35d093da76","service":"isi-archive-api","timestamp":"2025-06-04 11:49:18"}
{"level":"info","message":"Audit log created: LOGOUT by user 6d6185ab-372e-4d9f-b856-fb35d093da76","service":"isi-archive-api","timestamp":"2025-06-04 11:49:18"}
{"level":"info","message":"Successful login for user: admin@isi.tn","service":"isi-archive-api","timestamp":"2025-06-04 11:49:24"}
{"level":"info","message":"Audit log created: LOGIN by user 2448619c-5425-44e3-8703-30b6b4c38e61","service":"isi-archive-api","timestamp":"2025-06-04 11:49:24"}
{"level":"info","message":"User logged out: 2448619c-5425-44e3-8703-30b6b4c38e61","service":"isi-archive-api","timestamp":"2025-06-04 11:49:49"}
{"level":"info","message":"Audit log created: LOGOUT by user 2448619c-5425-44e3-8703-30b6b4c38e61","service":"isi-archive-api","timestamp":"2025-06-04 11:49:49"}
{"level":"info","message":"SIGTERM received, starting graceful shutdown...","service":"isi-archive-api","timestamp":"2025-06-04 11:55:36"}
{"level":"info","message":"HTTP server closed","service":"isi-archive-api","timestamp":"2025-06-04 11:55:36"}
