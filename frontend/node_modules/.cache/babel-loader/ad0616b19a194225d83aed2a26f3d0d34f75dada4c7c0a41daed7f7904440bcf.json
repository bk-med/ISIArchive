{"ast":null,"code":"import _objectSpread from\"/Users/brahimkhalilkhalef/Projects/ISIArchive/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{motion,AnimatePresence}from'framer-motion';import{X,Upload,FileText,AlertCircle,CheckCircle,Loader2,BookOpen,GraduationCap}from'lucide-react';import{useAuth}from'../../contexts/AuthContext';import{documentsAPI,academicAPI}from'../../utils/api';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const DocumentUploadModal=_ref=>{let{isOpen,onClose,onSuccess,preselectedMatiereId}=_ref;const{user}=useAuth();const[loading,setLoading]=useState(false);const[uploadType,setUploadType]=useState('document');const[niveaux,setNiveaux]=useState([]);const[filieres,setFilieres]=useState([]);const[semestres,setSemestres]=useState([]);const[matieres,setMatieres]=useState([]);const[professorMatieres,setProfessorMatieres]=useState([]);const[preselectedMatiere,setPreselectedMatiere]=useState(null);const[formData,setFormData]=useState({titre:'',description:'',categorie:'',matiereId:'',niveauId:'',filiereId:'',semestreId:'',// PFE specific fields\nanneeDiplome:new Date().getFullYear(),filiereDiplome:'',titreProjet:'',resume:'',motsCles:'',file:null});const[errors,setErrors]=useState({});const[isDragOver,setIsDragOver]=useState(false);const categories=[{value:'cours',label:'Cours'},{value:'td',label:'TD'},{value:'tp',label:'TP'},{value:'examen',label:'Examen'}];const allowedFileTypes=['application/pdf','application/msword','application/vnd.openxmlformats-officedocument.wordprocessingml.document','application/vnd.ms-powerpoint','application/vnd.openxmlformats-officedocument.presentationml.presentation'];const maxFileSize=50*1024*1024;// 50MB\nuseEffect(()=>{if(isOpen){fetchNiveaux();if((user===null||user===void 0?void 0:user.role)==='professeur'){fetchProfessorMatieres();}// Set preselected matiere if provided\nif(preselectedMatiereId){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{matiereId:preselectedMatiereId}));fetchPreselectedMatiere(preselectedMatiereId);}}},[isOpen,user,preselectedMatiereId]);useEffect(()=>{if(formData.niveauId){fetchFilieres(formData.niveauId);const niveau=niveaux.find(n=>n.id===formData.niveauId);setSemestres((niveau===null||niveau===void 0?void 0:niveau.semestres)||[]);}},[formData.niveauId,niveaux]);useEffect(()=>{if(formData.filiereId&&formData.semestreId){fetchMatieres(formData.filiereId,formData.semestreId);}},[formData.filiereId,formData.semestreId]);const fetchNiveaux=async()=>{try{const response=await academicAPI.getNiveaux();setNiveaux(response.data);}catch(error){console.error('Error fetching niveaux:',error);}};const fetchFilieres=async niveauId=>{try{const response=await academicAPI.getFilieres({niveauId});setFilieres(response.data);}catch(error){console.error('Error fetching filieres:',error);}};const fetchMatieres=async(filiereId,semestreId)=>{try{const response=await academicAPI.getMatieres({filiereId,semestreId});setMatieres(response.data);}catch(error){console.error('Error fetching matieres:',error);}};const fetchProfessorMatieres=async()=>{try{if(user!==null&&user!==void 0&&user.id){const response=await academicAPI.getProfesseurMatieres(user.id);setProfessorMatieres(response.data);}}catch(error){console.error('Error fetching professor matieres:',error);}};const fetchPreselectedMatiere=async matiereId=>{try{const response=await academicAPI.getMatiere(matiereId);setPreselectedMatiere(response.data);}catch(error){console.error('Error fetching preselected matiere:',error);}};const validateForm=()=>{const newErrors={};if(!formData.titre.trim()){newErrors.titre='Le titre est requis';}if(!formData.file){newErrors.file='Un fichier est requis';}else{if(!allowedFileTypes.includes(formData.file.type)){newErrors.file='Type de fichier non autorisé. Utilisez PDF, DOC, DOCX, PPT ou PPTX';}if(formData.file.size>maxFileSize){newErrors.file='Le fichier est trop volumineux (max 50MB)';}}if(uploadType==='document'){if(!formData.categorie){newErrors.categorie='La catégorie est requise';}if((user===null||user===void 0?void 0:user.role)==='professeur'){if(!formData.matiereId){newErrors.matiereId='La matière est requise';}}else{if(!formData.niveauId){newErrors.niveauId='Le niveau est requis';}if(!formData.filiereId){newErrors.filiereId='La filière est requise';}if(!formData.semestreId){newErrors.semestreId='Le semestre est requis';}if(!formData.matiereId){newErrors.matiereId='La matière est requise';}}}else{if(!formData.anneeDiplome||formData.anneeDiplome<2000||formData.anneeDiplome>new Date().getFullYear()){newErrors.anneeDiplome='Année de diplôme invalide';}if(!formData.filiereDiplome.trim()){newErrors.filiereDiplome='La filière de diplôme est requise';}if(!formData.titreProjet.trim()){newErrors.titreProjet='Le titre du projet est requis';}if(!formData.niveauId){newErrors.niveauId='Le niveau est requis';}if(!formData.filiereId){newErrors.filiereId='La filière est requise';}if(!formData.semestreId){newErrors.semestreId='Le semestre est requis';}}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async e=>{e.preventDefault();if(!validateForm()){return;}setLoading(true);try{const formDataToSend=new FormData();// Common fields\nformDataToSend.append('document',formData.file);formDataToSend.append('titre',formData.titre);if(formData.description){formDataToSend.append('description',formData.description);}if(uploadType==='document'){formDataToSend.append('categorie',formData.categorie);formDataToSend.append('matiereId',formData.matiereId);// Get matiere information for file organization\nconst matiere=(user===null||user===void 0?void 0:user.role)==='professeur'?professorMatieres.find(m=>m.id===formData.matiereId):matieres.find(m=>m.id===formData.matiereId);if(!matiere){throw new Error('Matière non trouvée');}// For professors, use the matiere's associated niveau, filiere, semestre\nif((user===null||user===void 0?void 0:user.role)==='professeur'){var _matiere$filiere,_matiere$filiere$nive,_matiere$filiere2,_matiere$semestre;const niveauNom=((_matiere$filiere=matiere.filiere)===null||_matiere$filiere===void 0?void 0:(_matiere$filiere$nive=_matiere$filiere.niveau)===null||_matiere$filiere$nive===void 0?void 0:_matiere$filiere$nive.nom)||'';const filiereNom=((_matiere$filiere2=matiere.filiere)===null||_matiere$filiere2===void 0?void 0:_matiere$filiere2.nom)||'';const semestreNom=((_matiere$semestre=matiere.semestre)===null||_matiere$semestre===void 0?void 0:_matiere$semestre.nom)||'';const matiereNom=matiere.nom||'';formDataToSend.append('niveau',niveauNom);formDataToSend.append('filiere',filiereNom);formDataToSend.append('semestre',semestreNom);formDataToSend.append('matiere',matiereNom);}else{// For admins, use the selected values\nconst niveau=niveaux.find(n=>n.id===formData.niveauId);const filiere=filieres.find(f=>f.id===formData.filiereId);const semestre=semestres.find(s=>s.id===formData.semestreId);const niveauNom=(niveau===null||niveau===void 0?void 0:niveau.nom)||'';const filiereNom=(filiere===null||filiere===void 0?void 0:filiere.nom)||'';const semestreNom=(semestre===null||semestre===void 0?void 0:semestre.nom)||'';const matiereNom=matiere.nom||'';formDataToSend.append('niveau',niveauNom);formDataToSend.append('filiere',filiereNom);formDataToSend.append('semestre',semestreNom);formDataToSend.append('matiere',matiereNom);}await documentsAPI.uploadDocument(formDataToSend);toast.success('Document ajouté avec succès');}else{// PFE document upload\nconst niveau=niveaux.find(n=>n.id===formData.niveauId);const filiere=filieres.find(f=>f.id===formData.filiereId);const semestre=semestres.find(s=>s.id===formData.semestreId);formDataToSend.append('niveau',(niveau===null||niveau===void 0?void 0:niveau.nom)||'');formDataToSend.append('filiere',(filiere===null||filiere===void 0?void 0:filiere.nom)||'');formDataToSend.append('semestre',(semestre===null||semestre===void 0?void 0:semestre.nom)||'');formDataToSend.append('anneeDiplome',formData.anneeDiplome.toString());formDataToSend.append('filiereDiplome',formData.filiereDiplome);formDataToSend.append('titreProjet',formData.titreProjet);if(formData.resume){formDataToSend.append('resume',formData.resume);}if(formData.motsCles){formDataToSend.append('motsCles',formData.motsCles);}await documentsAPI.uploadPFEDocument(formDataToSend);toast.success('Document PFE ajouté avec succès');}onSuccess();resetForm();}catch(error){var _error$response,_error$response$data;console.error('Error uploading document:',error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Erreur lors de l\\'ajout du document');}finally{setLoading(false);}};const resetForm=()=>{setFormData({titre:'',description:'',categorie:'',matiereId:'',niveauId:'',filiereId:'',semestreId:'',anneeDiplome:new Date().getFullYear(),filiereDiplome:'',titreProjet:'',resume:'',motsCles:'',file:null});setErrors({});setUploadType('document');setPreselectedMatiere(null);};const handleClose=()=>{resetForm();onClose();};const handleFileChange=e=>{var _e$target$files;const file=(_e$target$files=e.target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0];if(file){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{file}));if(errors.file){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{file:''}));}}};const handleInputChange=(field,value)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:value}));if(errors[field]){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{[field]:''}));}};const handleDragOver=e=>{e.preventDefault();e.stopPropagation();setIsDragOver(true);};const handleDragLeave=e=>{e.preventDefault();e.stopPropagation();setIsDragOver(false);};const handleDrop=e=>{e.preventDefault();e.stopPropagation();setIsDragOver(false);const files=e.dataTransfer.files;if(files&&files.length>0){const file=files[0];// Validate file type\nif(!allowedFileTypes.includes(file.type)){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{file:'Type de fichier non autorisé. Utilisez PDF, DOC, DOCX, PPT ou PPTX'}));return;}// Validate file size\nif(file.size>maxFileSize){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{file:'Le fichier est trop volumineux (max 50MB)'}));return;}setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{file}));if(errors.file){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{file:''}));}}};const canUploadPFE=(user===null||user===void 0?void 0:user.role)==='admin';return/*#__PURE__*/_jsx(AnimatePresence,{children:isOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0\",children:[/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:\"fixed inset-0 bg-gray-500 bg-opacity-75 z-40\",onClick:handleClose}),/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,scale:0.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:0.95,y:20},className:\"relative inline-block w-full max-w-2xl p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg z-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 bg-primary-100 rounded-lg\",children:/*#__PURE__*/_jsx(Upload,{className:\"w-6 h-6 text-primary-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:\"Ajouter un document\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Ajoutez un nouveau document \\xE0 la biblioth\\xE8que\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClose,className:\"p-2 text-gray-400 hover:text-gray-600 transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),canUploadPFE&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setUploadType('document'),className:\"flex-1 p-4 border-2 rounded-lg transition-colors \".concat(uploadType==='document'?'border-primary-500 bg-primary-50':'border-gray-200 hover:border-gray-300'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center space-x-2\",children:[/*#__PURE__*/_jsx(BookOpen,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Document acad\\xE9mique\"})]})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setUploadType('pfe'),className:\"flex-1 p-4 border-2 rounded-lg transition-colors \".concat(uploadType==='pfe'?'border-primary-500 bg-primary-50':'border-gray-200 hover:border-gray-300'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center space-x-2\",children:[/*#__PURE__*/_jsx(GraduationCap,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Document PFE\"})]})})]})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Fichier *\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md transition-colors \".concat(isDragOver?'border-primary-500 bg-primary-50':'border-gray-300 hover:border-gray-400'),onDragOver:handleDragOver,onDragLeave:handleDragLeave,onDrop:handleDrop,children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1 text-center\",children:[/*#__PURE__*/_jsx(FileText,{className:\"mx-auto h-12 w-12 \".concat(isDragOver?'text-primary-500':'text-gray-400')}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex text-sm text-gray-600\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"relative cursor-pointer bg-white rounded-md font-medium text-primary-600 hover:text-primary-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-500\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"T\\xE9l\\xE9charger un fichier\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",className:\"sr-only\",accept:\".pdf,.doc,.docx,.ppt,.pptx\",onChange:handleFileChange})]}),/*#__PURE__*/_jsx(\"p\",{className:\"pl-1\",children:\"ou glisser-d\\xE9poser\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:\"PDF, DOC, DOCX, PPT, PPTX jusqu'\\xE0 50MB\"}),formData.file&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-green-600 mt-2\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"inline w-4 h-4 mr-1\"}),formData.file.name]})]})}),errors.file&&/*#__PURE__*/_jsxs(\"p\",{className:\"mt-1 text-sm text-red-600 flex items-center\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-4 h-4 mr-1\"}),errors.file]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Titre *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.titre,onChange:e=>handleInputChange('titre',e.target.value),className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\",placeholder:\"Titre du document\"}),errors.titre&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.titre})]}),uploadType==='document'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Cat\\xE9gorie *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.categorie,onChange:e=>handleInputChange('categorie',e.target.value),className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner une cat\\xE9gorie\"}),categories.map(cat=>/*#__PURE__*/_jsx(\"option\",{value:cat.value,children:cat.label},cat.value))]}),errors.categorie&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.categorie})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.description,onChange:e=>handleInputChange('description',e.target.value),rows:3,className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\",placeholder:\"Description du document (optionnel)\"})]}),uploadType==='pfe'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Ann\\xE9e de dipl\\xF4me *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:formData.anneeDiplome,onChange:e=>handleInputChange('anneeDiplome',parseInt(e.target.value)),min:\"2000\",max:new Date().getFullYear(),className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"}),errors.anneeDiplome&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.anneeDiplome})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Fili\\xE8re de dipl\\xF4me *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.filiereDiplome,onChange:e=>handleInputChange('filiereDiplome',e.target.value),className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\",placeholder:\"Ex: Informatique et R\\xE9seaux\"}),errors.filiereDiplome&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.filiereDiplome})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Titre du projet *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.titreProjet,onChange:e=>handleInputChange('titreProjet',e.target.value),className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\",placeholder:\"Titre du projet de fin d'\\xE9tudes\"}),errors.titreProjet&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.titreProjet})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"R\\xE9sum\\xE9\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.resume,onChange:e=>handleInputChange('resume',e.target.value),rows:4,className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\",placeholder:\"R\\xE9sum\\xE9 du projet (optionnel)\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Mots-cl\\xE9s\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.motsCles,onChange:e=>handleInputChange('motsCles',e.target.value),className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\",placeholder:\"Mots-cl\\xE9s s\\xE9par\\xE9s par des virgules\"})]})]}),(user===null||user===void 0?void 0:user.role)==='admin'||uploadType==='pfe'?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900\",children:\"Organisation acad\\xE9mique *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Niveau *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.niveauId,onChange:e=>handleInputChange('niveauId',e.target.value),className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner un niveau\"}),niveaux.map(niveau=>/*#__PURE__*/_jsx(\"option\",{value:niveau.id,children:niveau.nom},niveau.id))]}),errors.niveauId&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.niveauId})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Fili\\xE8re *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.filiereId,onChange:e=>handleInputChange('filiereId',e.target.value),disabled:!formData.niveauId,className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 disabled:bg-gray-100\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner une fili\\xE8re\"}),filieres.map(filiere=>/*#__PURE__*/_jsx(\"option\",{value:filiere.id,children:filiere.nom},filiere.id))]}),errors.filiereId&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.filiereId})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Semestre *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.semestreId,onChange:e=>handleInputChange('semestreId',e.target.value),disabled:!formData.niveauId,className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 disabled:bg-gray-100\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner un semestre\"}),semestres.map(semestre=>/*#__PURE__*/_jsx(\"option\",{value:semestre.id,children:semestre.nom},semestre.id))]}),errors.semestreId&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.semestreId})]})]}),uploadType==='document'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Mati\\xE8re *\"}),preselectedMatiereId?/*#__PURE__*/_jsx(\"div\",{className:\"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md text-gray-900\",children:(()=>{const selectedMatiere=preselectedMatiere||professorMatieres.find(m=>m.id===preselectedMatiereId);return selectedMatiere?\"\".concat(selectedMatiere.nom,\" (\").concat(selectedMatiere.code,\")\"):'Matière sélectionnée';})()}):/*#__PURE__*/_jsxs(\"select\",{value:formData.matiereId,onChange:e=>handleInputChange('matiereId',e.target.value),disabled:!formData.filiereId||!formData.semestreId,className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 disabled:bg-gray-100\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner une mati\\xE8re\"}),professorMatieres.map(matiere=>/*#__PURE__*/_jsxs(\"option\",{value:matiere.id,children:[matiere.nom,\" (\",matiere.code,\")\"]},matiere.id))]}),errors.matiereId&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.matiereId})]})]}):(user===null||user===void 0?void 0:user.role)==='professeur'&&uploadType==='document'?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Mati\\xE8re *\"}),preselectedMatiereId?/*#__PURE__*/_jsx(\"div\",{className:\"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md text-gray-900\",children:(()=>{const selectedMatiere=professorMatieres.find(m=>m.id===preselectedMatiereId);return selectedMatiere?\"\".concat(selectedMatiere.nom,\" (\").concat(selectedMatiere.code,\")\"):'Matière sélectionnée';})()}):/*#__PURE__*/_jsxs(\"select\",{value:formData.matiereId,onChange:e=>handleInputChange('matiereId',e.target.value),className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner une mati\\xE8re\"}),professorMatieres.map(matiere=>/*#__PURE__*/_jsxs(\"option\",{value:matiere.id,children:[matiere.nom,\" (\",matiere.code,\")\"]},matiere.id))]}),errors.matiereId&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.matiereId})]}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-end space-x-3 pt-6 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleClose,className:\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\",children:\"Annuler\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-primary-600 border border-transparent rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed\",children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Loader2,{className:\"w-4 h-4 mr-2 animate-spin\"}),\"Ajout en cours...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Upload,{className:\"w-4 h-4 mr-2\"}),\"Ajouter\"]})})]})]})]})]})})});};export default DocumentUploadModal;","map":{"version":3,"names":["React","useState","useEffect","motion","AnimatePresence","X","Upload","FileText","AlertCircle","CheckCircle","Loader2","BookOpen","GraduationCap","useAuth","documentsAPI","academicAPI","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DocumentUploadModal","_ref","isOpen","onClose","onSuccess","preselectedMatiereId","user","loading","setLoading","uploadType","setUploadType","niveaux","setNiveaux","filieres","setFilieres","semestres","setSemestres","matieres","setMatieres","professorMatieres","setProfessorMatieres","preselectedMatiere","setPreselectedMatiere","formData","setFormData","titre","description","categorie","matiereId","niveauId","filiereId","semestreId","anneeDiplome","Date","getFullYear","filiereDiplome","titreProjet","resume","motsCles","file","errors","setErrors","isDragOver","setIsDragOver","categories","value","label","allowedFileTypes","maxFileSize","fetchNiveaux","role","fetchProfessorMatieres","prev","_objectSpread","fetchPreselectedMatiere","fetchFilieres","niveau","find","n","id","fetchMatieres","response","getNiveaux","data","error","console","getFilieres","getMatieres","getProfesseurMatieres","getMatiere","validateForm","newErrors","trim","includes","type","size","Object","keys","length","handleSubmit","e","preventDefault","formDataToSend","FormData","append","matiere","m","Error","_matiere$filiere","_matiere$filiere$nive","_matiere$filiere2","_matiere$semestre","niveauNom","filiere","nom","filiereNom","semestreNom","semestre","matiereNom","f","s","uploadDocument","success","toString","uploadPFEDocument","resetForm","_error$response","_error$response$data","message","handleClose","handleFileChange","_e$target$files","target","files","handleInputChange","field","handleDragOver","stopPropagation","handleDragLeave","handleDrop","dataTransfer","canUploadPFE","children","className","div","initial","opacity","animate","exit","onClick","scale","y","concat","onSubmit","onDragOver","onDragLeave","onDrop","accept","onChange","name","placeholder","map","cat","rows","parseInt","min","max","disabled","selectedMatiere","code"],"sources":["/Users/brahimkhalilkhalef/Projects/ISIArchive/frontend/src/components/forms/DocumentUploadModal.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n  X,\n  Upload,\n  FileText,\n  AlertCircle,\n  CheckCircle,\n  Loader2,\n  BookOpen,\n  GraduationCap\n} from 'lucide-react';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { documentsAPI, academicAPI } from '../../utils/api';\nimport { CreateDocumentData, CreatePFEDocumentData, Matiere, Filiere, Niveau, Semestre } from '../../types';\nimport toast from 'react-hot-toast';\n\ninterface DocumentUploadModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess: () => void;\n  preselectedMatiereId?: string;\n}\n\nconst DocumentUploadModal: React.FC<DocumentUploadModalProps> = ({\n  isOpen,\n  onClose,\n  onSuccess,\n  preselectedMatiereId\n}) => {\n  const { user } = useAuth();\n  const [loading, setLoading] = useState(false);\n  const [uploadType, setUploadType] = useState<'document' | 'pfe'>('document');\n  const [niveaux, setNiveaux] = useState<Niveau[]>([]);\n  const [filieres, setFilieres] = useState<Filiere[]>([]);\n  const [semestres, setSemestres] = useState<Semestre[]>([]);\n  const [matieres, setMatieres] = useState<Matiere[]>([]);\n  const [professorMatieres, setProfessorMatieres] = useState<Matiere[]>([]);\n  const [preselectedMatiere, setPreselectedMatiere] = useState<Matiere | null>(null);\n\n  const [formData, setFormData] = useState({\n    titre: '',\n    description: '',\n    categorie: '',\n    matiereId: '',\n    niveauId: '',\n    filiereId: '',\n    semestreId: '',\n    // PFE specific fields\n    anneeDiplome: new Date().getFullYear(),\n    filiereDiplome: '',\n    titreProjet: '',\n    resume: '',\n    motsCles: '',\n    file: null as File | null\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isDragOver, setIsDragOver] = useState(false);\n\n  const categories = [\n    { value: 'cours', label: 'Cours' },\n    { value: 'td', label: 'TD' },\n    { value: 'tp', label: 'TP' },\n    { value: 'examen', label: 'Examen' }\n  ];\n\n  const allowedFileTypes = [\n    'application/pdf',\n    'application/msword',\n    'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n    'application/vnd.ms-powerpoint',\n    'application/vnd.openxmlformats-officedocument.presentationml.presentation'\n  ];\n\n  const maxFileSize = 50 * 1024 * 1024; // 50MB\n\n  useEffect(() => {\n    if (isOpen) {\n      fetchNiveaux();\n      if (user?.role === 'professeur') {\n        fetchProfessorMatieres();\n      }\n      \n      // Set preselected matiere if provided\n      if (preselectedMatiereId) {\n        setFormData(prev => ({ ...prev, matiereId: preselectedMatiereId }));\n        fetchPreselectedMatiere(preselectedMatiereId);\n      }\n    }\n  }, [isOpen, user, preselectedMatiereId]);\n\n  useEffect(() => {\n    if (formData.niveauId) {\n      fetchFilieres(formData.niveauId);\n      const niveau = niveaux.find(n => n.id === formData.niveauId);\n      setSemestres(niveau?.semestres || []);\n    }\n  }, [formData.niveauId, niveaux]);\n\n  useEffect(() => {\n    if (formData.filiereId && formData.semestreId) {\n      fetchMatieres(formData.filiereId, formData.semestreId);\n    }\n  }, [formData.filiereId, formData.semestreId]);\n\n  const fetchNiveaux = async () => {\n    try {\n      const response = await academicAPI.getNiveaux();\n      setNiveaux(response.data);\n    } catch (error) {\n      console.error('Error fetching niveaux:', error);\n    }\n  };\n\n  const fetchFilieres = async (niveauId: string) => {\n    try {\n      const response = await academicAPI.getFilieres({ niveauId });\n      setFilieres(response.data);\n    } catch (error) {\n      console.error('Error fetching filieres:', error);\n    }\n  };\n\n  const fetchMatieres = async (filiereId: string, semestreId: string) => {\n    try {\n      const response = await academicAPI.getMatieres({ filiereId, semestreId });\n      setMatieres(response.data);\n    } catch (error) {\n      console.error('Error fetching matieres:', error);\n    }\n  };\n\n  const fetchProfessorMatieres = async () => {\n    try {\n      if (user?.id) {\n        const response = await academicAPI.getProfesseurMatieres(user.id);\n        setProfessorMatieres(response.data);\n      }\n    } catch (error) {\n      console.error('Error fetching professor matieres:', error);\n    }\n  };\n\n  const fetchPreselectedMatiere = async (matiereId: string) => {\n    try {\n      const response = await academicAPI.getMatiere(matiereId);\n      setPreselectedMatiere(response.data);\n    } catch (error) {\n      console.error('Error fetching preselected matiere:', error);\n    }\n  };\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.titre.trim()) {\n      newErrors.titre = 'Le titre est requis';\n    }\n\n    if (!formData.file) {\n      newErrors.file = 'Un fichier est requis';\n    } else {\n      if (!allowedFileTypes.includes(formData.file.type)) {\n        newErrors.file = 'Type de fichier non autorisé. Utilisez PDF, DOC, DOCX, PPT ou PPTX';\n      }\n      if (formData.file.size > maxFileSize) {\n        newErrors.file = 'Le fichier est trop volumineux (max 50MB)';\n      }\n    }\n\n    if (uploadType === 'document') {\n      if (!formData.categorie) {\n        newErrors.categorie = 'La catégorie est requise';\n      }\n      if (user?.role === 'professeur') {\n        if (!formData.matiereId) {\n          newErrors.matiereId = 'La matière est requise';\n        }\n      } else {\n        if (!formData.niveauId) {\n          newErrors.niveauId = 'Le niveau est requis';\n        }\n        if (!formData.filiereId) {\n          newErrors.filiereId = 'La filière est requise';\n        }\n        if (!formData.semestreId) {\n          newErrors.semestreId = 'Le semestre est requis';\n        }\n        if (!formData.matiereId) {\n          newErrors.matiereId = 'La matière est requise';\n        }\n      }\n    } else {\n      if (!formData.anneeDiplome || formData.anneeDiplome < 2000 || formData.anneeDiplome > new Date().getFullYear()) {\n        newErrors.anneeDiplome = 'Année de diplôme invalide';\n      }\n      if (!formData.filiereDiplome.trim()) {\n        newErrors.filiereDiplome = 'La filière de diplôme est requise';\n      }\n      if (!formData.titreProjet.trim()) {\n        newErrors.titreProjet = 'Le titre du projet est requis';\n      }\n      if (!formData.niveauId) {\n        newErrors.niveauId = 'Le niveau est requis';\n      }\n      if (!formData.filiereId) {\n        newErrors.filiereId = 'La filière est requise';\n      }\n      if (!formData.semestreId) {\n        newErrors.semestreId = 'Le semestre est requis';\n      }\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const formDataToSend = new FormData();\n      \n      // Common fields\n      formDataToSend.append('document', formData.file!);\n      formDataToSend.append('titre', formData.titre);\n      if (formData.description) {\n        formDataToSend.append('description', formData.description);\n      }\n\n      if (uploadType === 'document') {\n        formDataToSend.append('categorie', formData.categorie);\n        formDataToSend.append('matiereId', formData.matiereId);\n        \n        // Get matiere information for file organization\n        const matiere = user?.role === 'professeur' \n          ? professorMatieres.find(m => m.id === formData.matiereId)\n          : matieres.find(m => m.id === formData.matiereId);\n\n        if (!matiere) {\n          throw new Error('Matière non trouvée');\n        }\n\n        // For professors, use the matiere's associated niveau, filiere, semestre\n        if (user?.role === 'professeur') {\n          const niveauNom = matiere.filiere?.niveau?.nom || '';\n          const filiereNom = matiere.filiere?.nom || '';\n          const semestreNom = matiere.semestre?.nom || '';\n          const matiereNom = matiere.nom || '';\n\n          formDataToSend.append('niveau', niveauNom);\n          formDataToSend.append('filiere', filiereNom);\n          formDataToSend.append('semestre', semestreNom);\n          formDataToSend.append('matiere', matiereNom);\n        } else {\n          // For admins, use the selected values\n          const niveau = niveaux.find(n => n.id === formData.niveauId);\n          const filiere = filieres.find(f => f.id === formData.filiereId);\n          const semestre = semestres.find(s => s.id === formData.semestreId);\n\n          const niveauNom = niveau?.nom || '';\n          const filiereNom = filiere?.nom || '';\n          const semestreNom = semestre?.nom || '';\n          const matiereNom = matiere.nom || '';\n\n          formDataToSend.append('niveau', niveauNom);\n          formDataToSend.append('filiere', filiereNom);\n          formDataToSend.append('semestre', semestreNom);\n          formDataToSend.append('matiere', matiereNom);\n        }\n\n        await documentsAPI.uploadDocument(formDataToSend);\n        toast.success('Document ajouté avec succès');\n      } else {\n        // PFE document upload\n        const niveau = niveaux.find(n => n.id === formData.niveauId);\n        const filiere = filieres.find(f => f.id === formData.filiereId);\n        const semestre = semestres.find(s => s.id === formData.semestreId);\n\n        formDataToSend.append('niveau', niveau?.nom || '');\n        formDataToSend.append('filiere', filiere?.nom || '');\n        formDataToSend.append('semestre', semestre?.nom || '');\n        \n        formDataToSend.append('anneeDiplome', formData.anneeDiplome.toString());\n        formDataToSend.append('filiereDiplome', formData.filiereDiplome);\n        formDataToSend.append('titreProjet', formData.titreProjet);\n        if (formData.resume) {\n          formDataToSend.append('resume', formData.resume);\n        }\n        if (formData.motsCles) {\n          formDataToSend.append('motsCles', formData.motsCles);\n        }\n\n        await documentsAPI.uploadPFEDocument(formDataToSend);\n        toast.success('Document PFE ajouté avec succès');\n      }\n\n      onSuccess();\n      resetForm();\n    } catch (error: any) {\n      console.error('Error uploading document:', error);\n      toast.error(error.response?.data?.message || 'Erreur lors de l\\'ajout du document');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const resetForm = () => {\n    setFormData({\n      titre: '',\n      description: '',\n      categorie: '',\n      matiereId: '',\n      niveauId: '',\n      filiereId: '',\n      semestreId: '',\n      anneeDiplome: new Date().getFullYear(),\n      filiereDiplome: '',\n      titreProjet: '',\n      resume: '',\n      motsCles: '',\n      file: null\n    });\n    setErrors({});\n    setUploadType('document');\n    setPreselectedMatiere(null);\n  };\n\n  const handleClose = () => {\n    resetForm();\n    onClose();\n  };\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      setFormData(prev => ({ ...prev, file }));\n      if (errors.file) {\n        setErrors(prev => ({ ...prev, file: '' }));\n      }\n    }\n  };\n\n  const handleInputChange = (field: string, value: string | number) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: '' }));\n    }\n  };\n\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragOver(true);\n  };\n\n  const handleDragLeave = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragOver(false);\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragOver(false);\n\n    const files = e.dataTransfer.files;\n    if (files && files.length > 0) {\n      const file = files[0];\n      \n      // Validate file type\n      if (!allowedFileTypes.includes(file.type)) {\n        setErrors(prev => ({ ...prev, file: 'Type de fichier non autorisé. Utilisez PDF, DOC, DOCX, PPT ou PPTX' }));\n        return;\n      }\n      \n      // Validate file size\n      if (file.size > maxFileSize) {\n        setErrors(prev => ({ ...prev, file: 'Le fichier est trop volumineux (max 50MB)' }));\n        return;\n      }\n\n      setFormData(prev => ({ ...prev, file }));\n      if (errors.file) {\n        setErrors(prev => ({ ...prev, file: '' }));\n      }\n    }\n  };\n\n  const canUploadPFE = user?.role === 'admin';\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <div className=\"fixed inset-0 z-50 overflow-y-auto\">\n          <div className=\"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0\">\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              className=\"fixed inset-0 bg-gray-500 bg-opacity-75 z-40\"\n              onClick={handleClose}\n            />\n\n            <motion.div\n              initial={{ opacity: 0, scale: 0.95, y: 20 }}\n              animate={{ opacity: 1, scale: 1, y: 0 }}\n              exit={{ opacity: 0, scale: 0.95, y: 20 }}\n              className=\"relative inline-block w-full max-w-2xl p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg z-50\"\n            >\n              <div className=\"flex items-center justify-between mb-6\">\n                <div className=\"flex items-center space-x-3\">\n                  <div className=\"p-2 bg-primary-100 rounded-lg\">\n                    <Upload className=\"w-6 h-6 text-primary-600\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-medium text-gray-900\">\n                      Ajouter un document\n                    </h3>\n                    <p className=\"text-sm text-gray-500\">\n                      Ajoutez un nouveau document à la bibliothèque\n                    </p>\n                  </div>\n                </div>\n                <button\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-400 hover:text-gray-600 transition-colors\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </button>\n              </div>\n\n              {/* Upload Type Selection */}\n              {canUploadPFE && (\n                <div className=\"mb-6\">\n                  <div className=\"flex space-x-4\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setUploadType('document')}\n                      className={`flex-1 p-4 border-2 rounded-lg transition-colors ${\n                        uploadType === 'document'\n                          ? 'border-primary-500 bg-primary-50'\n                          : 'border-gray-200 hover:border-gray-300'\n                      }`}\n                    >\n                      <div className=\"flex items-center justify-center space-x-2\">\n                        <BookOpen className=\"w-5 h-5\" />\n                        <span className=\"font-medium\">Document académique</span>\n                      </div>\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={() => setUploadType('pfe')}\n                      className={`flex-1 p-4 border-2 rounded-lg transition-colors ${\n                        uploadType === 'pfe'\n                          ? 'border-primary-500 bg-primary-50'\n                          : 'border-gray-200 hover:border-gray-300'\n                      }`}\n                    >\n                      <div className=\"flex items-center justify-center space-x-2\">\n                        <GraduationCap className=\"w-5 h-5\" />\n                        <span className=\"font-medium\">Document PFE</span>\n                      </div>\n                    </button>\n                  </div>\n                </div>\n              )}\n\n              <form onSubmit={handleSubmit} className=\"space-y-6\">\n                {/* File Upload */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Fichier *\n                  </label>\n                  <div \n                    className={`mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md transition-colors ${\n                      isDragOver \n                        ? 'border-primary-500 bg-primary-50' \n                        : 'border-gray-300 hover:border-gray-400'\n                    }`}\n                    onDragOver={handleDragOver}\n                    onDragLeave={handleDragLeave}\n                    onDrop={handleDrop}\n                  >\n                    <div className=\"space-y-1 text-center\">\n                      <FileText className={`mx-auto h-12 w-12 ${isDragOver ? 'text-primary-500' : 'text-gray-400'}`} />\n                      <div className=\"flex text-sm text-gray-600\">\n                        <label className=\"relative cursor-pointer bg-white rounded-md font-medium text-primary-600 hover:text-primary-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-500\">\n                          <span>Télécharger un fichier</span>\n                          <input\n                            type=\"file\"\n                            className=\"sr-only\"\n                            accept=\".pdf,.doc,.docx,.ppt,.pptx\"\n                            onChange={handleFileChange}\n                          />\n                        </label>\n                        <p className=\"pl-1\">ou glisser-déposer</p>\n                      </div>\n                      <p className=\"text-xs text-gray-500\">\n                        PDF, DOC, DOCX, PPT, PPTX jusqu'à 50MB\n                      </p>\n                      {formData.file && (\n                        <p className=\"text-sm text-green-600 mt-2\">\n                          <CheckCircle className=\"inline w-4 h-4 mr-1\" />\n                          {formData.file.name}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                  {errors.file && (\n                    <p className=\"mt-1 text-sm text-red-600 flex items-center\">\n                      <AlertCircle className=\"w-4 h-4 mr-1\" />\n                      {errors.file}\n                    </p>\n                  )}\n                </div>\n\n                {/* Basic Information */}\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      Titre *\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={formData.titre}\n                      onChange={(e) => handleInputChange('titre', e.target.value)}\n                      className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                      placeholder=\"Titre du document\"\n                    />\n                    {errors.titre && (\n                      <p className=\"mt-1 text-sm text-red-600\">{errors.titre}</p>\n                    )}\n                  </div>\n\n                  {uploadType === 'document' && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Catégorie *\n                      </label>\n                      <select\n                        value={formData.categorie}\n                        onChange={(e) => handleInputChange('categorie', e.target.value)}\n                        className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                      >\n                        <option value=\"\">Sélectionner une catégorie</option>\n                        {categories.map(cat => (\n                          <option key={cat.value} value={cat.value}>{cat.label}</option>\n                        ))}\n                      </select>\n                      {errors.categorie && (\n                        <p className=\"mt-1 text-sm text-red-600\">{errors.categorie}</p>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Description\n                  </label>\n                  <textarea\n                    value={formData.description}\n                    onChange={(e) => handleInputChange('description', e.target.value)}\n                    rows={3}\n                    className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                    placeholder=\"Description du document (optionnel)\"\n                  />\n                </div>\n\n                {/* PFE Specific Fields */}\n                {uploadType === 'pfe' && (\n                  <div className=\"space-y-4\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                          Année de diplôme *\n                        </label>\n                        <input\n                          type=\"number\"\n                          value={formData.anneeDiplome}\n                          onChange={(e) => handleInputChange('anneeDiplome', parseInt(e.target.value))}\n                          min=\"2000\"\n                          max={new Date().getFullYear()}\n                          className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                        />\n                        {errors.anneeDiplome && (\n                          <p className=\"mt-1 text-sm text-red-600\">{errors.anneeDiplome}</p>\n                        )}\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                          Filière de diplôme *\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.filiereDiplome}\n                          onChange={(e) => handleInputChange('filiereDiplome', e.target.value)}\n                          className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                          placeholder=\"Ex: Informatique et Réseaux\"\n                        />\n                        {errors.filiereDiplome && (\n                          <p className=\"mt-1 text-sm text-red-600\">{errors.filiereDiplome}</p>\n                        )}\n                      </div>\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Titre du projet *\n                      </label>\n                      <input\n                        type=\"text\"\n                        value={formData.titreProjet}\n                        onChange={(e) => handleInputChange('titreProjet', e.target.value)}\n                        className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                        placeholder=\"Titre du projet de fin d'études\"\n                      />\n                      {errors.titreProjet && (\n                        <p className=\"mt-1 text-sm text-red-600\">{errors.titreProjet}</p>\n                      )}\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Résumé\n                      </label>\n                      <textarea\n                        value={formData.resume}\n                        onChange={(e) => handleInputChange('resume', e.target.value)}\n                        rows={4}\n                        className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                        placeholder=\"Résumé du projet (optionnel)\"\n                      />\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                        Mots-clés\n                      </label>\n                      <input\n                        type=\"text\"\n                        value={formData.motsCles}\n                        onChange={(e) => handleInputChange('motsCles', e.target.value)}\n                        className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                        placeholder=\"Mots-clés séparés par des virgules\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n                {/* Academic Structure Selection */}\n                {user?.role === 'admin' || uploadType === 'pfe' ? (\n                  <div className=\"space-y-4\">\n                    <h4 className=\"text-sm font-medium text-gray-900\">\n                      Organisation académique *\n                    </h4>\n                    \n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                          Niveau *\n                        </label>\n                        <select\n                          value={formData.niveauId}\n                          onChange={(e) => handleInputChange('niveauId', e.target.value)}\n                          className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                        >\n                          <option value=\"\">Sélectionner un niveau</option>\n                          {niveaux.map(niveau => (\n                            <option key={niveau.id} value={niveau.id}>{niveau.nom}</option>\n                          ))}\n                        </select>\n                        {errors.niveauId && (\n                          <p className=\"mt-1 text-sm text-red-600\">{errors.niveauId}</p>\n                        )}\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                          Filière *\n                        </label>\n                        <select\n                          value={formData.filiereId}\n                          onChange={(e) => handleInputChange('filiereId', e.target.value)}\n                          disabled={!formData.niveauId}\n                          className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 disabled:bg-gray-100\"\n                        >\n                          <option value=\"\">Sélectionner une filière</option>\n                          {filieres.map(filiere => (\n                            <option key={filiere.id} value={filiere.id}>{filiere.nom}</option>\n                          ))}\n                        </select>\n                        {errors.filiereId && (\n                          <p className=\"mt-1 text-sm text-red-600\">{errors.filiereId}</p>\n                        )}\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                          Semestre *\n                        </label>\n                        <select\n                          value={formData.semestreId}\n                          onChange={(e) => handleInputChange('semestreId', e.target.value)}\n                          disabled={!formData.niveauId}\n                          className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 disabled:bg-gray-100\"\n                        >\n                          <option value=\"\">Sélectionner un semestre</option>\n                          {semestres.map(semestre => (\n                            <option key={semestre.id} value={semestre.id}>{semestre.nom}</option>\n                          ))}\n                        </select>\n                        {errors.semestreId && (\n                          <p className=\"mt-1 text-sm text-red-600\">{errors.semestreId}</p>\n                        )}\n                      </div>\n                    </div>\n\n                    {uploadType === 'document' && (\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                          Matière *\n                        </label>\n                        {preselectedMatiereId ? (\n                          <div className=\"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md text-gray-900\">\n                            {(() => {\n                              const selectedMatiere = preselectedMatiere || professorMatieres.find(m => m.id === preselectedMatiereId);\n                              return selectedMatiere ? `${selectedMatiere.nom} (${selectedMatiere.code})` : 'Matière sélectionnée';\n                            })()}\n                          </div>\n                        ) : (\n                          <select\n                            value={formData.matiereId}\n                            onChange={(e) => handleInputChange('matiereId', e.target.value)}\n                            disabled={!formData.filiereId || !formData.semestreId}\n                            className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 disabled:bg-gray-100\"\n                          >\n                            <option value=\"\">Sélectionner une matière</option>\n                            {professorMatieres.map(matiere => (\n                              <option key={matiere.id} value={matiere.id}>\n                                {matiere.nom} ({matiere.code})\n                              </option>\n                            ))}\n                          </select>\n                        )}\n                        {errors.matiereId && (\n                          <p className=\"mt-1 text-sm text-red-600\">{errors.matiereId}</p>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                ) : user?.role === 'professeur' && uploadType === 'document' ? (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      Matière *\n                    </label>\n                    {preselectedMatiereId ? (\n                      <div className=\"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md text-gray-900\">\n                        {(() => {\n                          const selectedMatiere = professorMatieres.find(m => m.id === preselectedMatiereId);\n                          return selectedMatiere ? `${selectedMatiere.nom} (${selectedMatiere.code})` : 'Matière sélectionnée';\n                        })()}\n                      </div>\n                    ) : (\n                      <select\n                        value={formData.matiereId}\n                        onChange={(e) => handleInputChange('matiereId', e.target.value)}\n                        className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                      >\n                        <option value=\"\">Sélectionner une matière</option>\n                        {professorMatieres.map(matiere => (\n                          <option key={matiere.id} value={matiere.id}>\n                            {matiere.nom} ({matiere.code})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                    {errors.matiereId && (\n                      <p className=\"mt-1 text-sm text-red-600\">{errors.matiereId}</p>\n                    )}\n                  </div>\n                ) : null}\n\n                {/* Actions */}\n                <div className=\"flex items-center justify-end space-x-3 pt-6 border-t border-gray-200\">\n                  <button\n                    type=\"button\"\n                    onClick={handleClose}\n                    className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n                  >\n                    Annuler\n                  </button>\n                  <button\n                    type=\"submit\"\n                    disabled={loading}\n                    className=\"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-primary-600 border border-transparent rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    {loading ? (\n                      <>\n                        <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                        Ajout en cours...\n                      </>\n                    ) : (\n                      <>\n                        <Upload className=\"w-4 h-4 mr-2\" />\n                        Ajouter\n                      </>\n                    )}\n                  </button>\n                </div>\n              </form>\n            </motion.div>\n          </div>\n        </div>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default DocumentUploadModal; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}