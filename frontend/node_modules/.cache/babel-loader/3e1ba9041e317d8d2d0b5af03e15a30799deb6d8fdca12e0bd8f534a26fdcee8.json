{"ast":null,"code":"import React,{useState,useEffect}from'react';import{motion,AnimatePresence}from'framer-motion';import{X,Download,FileText,Calendar,User,MessageCircle,Send,Edit2,Trash2,Reply,BookOpen,GraduationCap,Star,FileIcon,Loader2}from'lucide-react';import{useAuth}from'../../contexts/AuthContext';import{documentsAPI,commentsAPI}from'../../utils/api';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const DocumentViewModal=_ref=>{let{isOpen,onClose,document,onDownload}=_ref;const{user}=useAuth();const[comments,setComments]=useState([]);const[loading,setLoading]=useState(false);const[submitting,setSubmitting]=useState(false);const[newComment,setNewComment]=useState('');const[replyTo,setReplyTo]=useState(null);const[editingComment,setEditingComment]=useState(null);const[editContent,setEditContent]=useState('');useEffect(()=>{if(isOpen&&document){fetchComments();}},[isOpen,document]);const fetchComments=async()=>{try{setLoading(true);const response=await documentsAPI.getDocumentComments(document.id);setComments(response.data);}catch(error){console.error('Error fetching comments:',error);toast.error('Erreur lors du chargement des commentaires');}finally{setLoading(false);}};const handleSubmitComment=async e=>{e.preventDefault();if(!newComment.trim())return;try{setSubmitting(true);await documentsAPI.createComment(document.id,{contenu:newComment,parentId:replyTo||undefined});setNewComment('');setReplyTo(null);await fetchComments();toast.success('Commentaire ajouté avec succès');}catch(error){console.error('Error creating comment:',error);toast.error('Erreur lors de l\\'ajout du commentaire');}finally{setSubmitting(false);}};const handleEditComment=async commentId=>{if(!editContent.trim())return;try{await commentsAPI.updateComment(commentId,{contenu:editContent});setEditingComment(null);setEditContent('');await fetchComments();toast.success('Commentaire modifié avec succès');}catch(error){console.error('Error updating comment:',error);toast.error('Erreur lors de la modification du commentaire');}};const handleDeleteComment=async commentId=>{if(!window.confirm('Êtes-vous sûr de vouloir supprimer ce commentaire ?'))return;try{await commentsAPI.deleteComment(commentId);await fetchComments();toast.success('Commentaire supprimé avec succès');}catch(error){console.error('Error deleting comment:',error);toast.error('Erreur lors de la suppression du commentaire');}};const startEdit=comment=>{setEditingComment(comment.id);setEditContent(comment.contenu);};const cancelEdit=()=>{setEditingComment(null);setEditContent('');};const formatFileSize=bytes=>{const size=parseInt(bytes);if(size===0)return'0 B';const k=1024;const sizes=['B','KB','MB','GB'];const i=Math.floor(Math.log(size)/Math.log(k));return parseFloat((size/Math.pow(k,i)).toFixed(2))+' '+sizes[i];};const getCategoryIcon=categorie=>{switch(categorie){case'cours':return BookOpen;case'td':return FileText;case'tp':return FileIcon;case'examen':return Calendar;case'correction':return Star;case'pfe':return GraduationCap;default:return FileText;}};const getCategoryColor=categorie=>{switch(categorie){case'cours':return'bg-blue-100 text-blue-800';case'td':return'bg-green-100 text-green-800';case'tp':return'bg-purple-100 text-purple-800';case'examen':return'bg-red-100 text-red-800';case'correction':return'bg-yellow-100 text-yellow-800';case'pfe':return'bg-indigo-100 text-indigo-800';default:return'bg-gray-100 text-gray-800';}};const canEditComment=comment=>{return(user===null||user===void 0?void 0:user.id)===comment.auteurId||(user===null||user===void 0?void 0:user.role)==='admin';};const renderComment=function(comment){let isReply=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;const isEditing=editingComment===comment.id;return/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(isReply?'ml-8 border-l-2 border-gray-200 pl-4':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-lg p-4 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(User,{className:\"w-4 h-4 text-primary-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm font-medium text-gray-900\",children:[comment.auteur.prenom,\" \",comment.auteur.nom]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:new Date(comment.createdAt).toLocaleDateString('fr-FR',{year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit'})})]})]}),canEditComment(comment)&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>startEdit(comment),className:\"p-1 text-gray-400 hover:text-gray-600\",title:\"Modifier\",children:/*#__PURE__*/_jsx(Edit2,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteComment(comment.id),className:\"p-1 text-gray-400 hover:text-red-600\",title:\"Supprimer\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]})]}),isEditing?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:editContent,onChange:e=>setEditContent(e.target.value),className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\",rows:3}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEditComment(comment.id),className:\"px-3 py-1 text-sm bg-primary-600 text-white rounded-md hover:bg-primary-700\",children:\"Sauvegarder\"}),/*#__PURE__*/_jsx(\"button\",{onClick:cancelEdit,className:\"px-3 py-1 text-sm bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400\",children:\"Annuler\"})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 mb-2\",children:comment.contenu}),!isReply&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setReplyTo(comment.id),className:\"text-sm text-primary-600 hover:text-primary-800 flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(Reply,{className:\"w-3 h-3\"}),/*#__PURE__*/_jsx(\"span\",{children:\"R\\xE9pondre\"})]})]})]}),comment.reponses&&comment.reponses.map(reply=>renderComment(reply,true))]},comment.id);};const CategoryIcon=getCategoryIcon(document.categorie);return/*#__PURE__*/_jsx(AnimatePresence,{children:isOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0\",children:[/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:\"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75\",onClick:onClose}),/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,scale:0.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:0.95,y:20},className:\"inline-block w-full max-w-4xl p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 bg-gray-100 rounded-lg\",children:/*#__PURE__*/_jsx(CategoryIcon,{className:\"w-6 h-6 text-gray-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:document.titre}),/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium \".concat(getCategoryColor(document.categorie)),children:document.categorie.toUpperCase()})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"p-2 text-gray-400 hover:text-gray-600 transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-2\",children:\"Description\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700\",children:document.description||'Aucune description disponible.'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-1\",children:\"Auteur\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700\",children:[document.uploader.prenom,\" \",document.uploader.nom]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-1\",children:\"Date\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700\",children:new Date(document.createdAt).toLocaleDateString('fr-FR')})]})]}),document.matiere&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-1\",children:\"Mati\\xE8re\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700\",children:[document.matiere.nom,\" (\",document.matiere.code,\")\"]})]}),document.pfeData&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-1\",children:\"Projet PFE\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700\",children:document.pfeData.titreProjet})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-1\",children:\"Ann\\xE9e\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700\",children:document.pfeData.anneeDiplome})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-1\",children:\"Fili\\xE8re\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700\",children:document.pfeData.filiereDiplome})]})]}),document.pfeData.resume&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-1\",children:\"R\\xE9sum\\xE9\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700\",children:document.pfeData.resume})]}),document.pfeData.motsCles.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-1\",children:\"Mots-cl\\xE9s\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1\",children:document.pfeData.motsCles.map((tag,index)=>/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800\",children:tag},index))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-1\",children:\"Taille\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700\",children:formatFileSize(document.tailleFichier)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-1\",children:\"Type\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700\",children:document.typeMime})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-3 pt-4\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:onDownload,className:\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-4 h-4 mr-2\"}),\"T\\xE9l\\xE9charger\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(MessageCircle,{className:\"w-5 h-5 text-gray-600\"}),/*#__PURE__*/_jsxs(\"h4\",{className:\"text-lg font-medium text-gray-900\",children:[\"Commentaires (\",comments.length,\")\"]})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitComment,className:\"space-y-3\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:newComment,onChange:e=>setNewComment(e.target.value),placeholder:replyTo?\"Écrire une réponse...\":\"Ajouter un commentaire...\",className:\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\",rows:3}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[replyTo&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setReplyTo(null),className:\"text-sm text-gray-500 hover:text-gray-700\",children:\"Annuler la r\\xE9ponse\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",disabled:submitting||!newComment.trim(),className:\"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed ml-auto\",children:[submitting?/*#__PURE__*/_jsx(Loader2,{className:\"w-4 h-4 mr-2 animate-spin\"}):/*#__PURE__*/_jsx(Send,{className:\"w-4 h-4 mr-2\"}),replyTo?'Répondre':'Commenter']})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto space-y-4\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center py-8\",children:/*#__PURE__*/_jsx(Loader2,{className:\"w-6 h-6 animate-spin text-primary-600\"})}):comments.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(MessageCircle,{className:\"mx-auto h-8 w-8 text-gray-400\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-sm text-gray-500\",children:\"Aucun commentaire pour le moment.\"})]}):comments.filter(comment=>!comment.parentId)// Only show top-level comments\n.map(comment=>renderComment(comment))})]})]})]})]})})});};export default DocumentViewModal;","map":{"version":3,"names":["React","useState","useEffect","motion","AnimatePresence","X","Download","FileText","Calendar","User","MessageCircle","Send","Edit2","Trash2","Reply","BookOpen","GraduationCap","Star","FileIcon","Loader2","useAuth","documentsAPI","commentsAPI","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DocumentViewModal","_ref","isOpen","onClose","document","onDownload","user","comments","setComments","loading","setLoading","submitting","setSubmitting","newComment","setNewComment","replyTo","setReplyTo","editingComment","setEditingComment","editContent","setEditContent","fetchComments","response","getDocumentComments","id","data","error","console","handleSubmitComment","e","preventDefault","trim","createComment","contenu","parentId","undefined","success","handleEditComment","commentId","updateComment","handleDeleteComment","window","confirm","deleteComment","startEdit","comment","cancelEdit","formatFileSize","bytes","size","parseInt","k","sizes","i","Math","floor","log","parseFloat","pow","toFixed","getCategoryIcon","categorie","getCategoryColor","canEditComment","auteurId","role","renderComment","isReply","arguments","length","isEditing","className","concat","children","auteur","prenom","nom","Date","createdAt","toLocaleDateString","year","month","day","hour","minute","onClick","title","value","onChange","target","rows","reponses","map","reply","CategoryIcon","div","initial","opacity","animate","exit","scale","y","titre","toUpperCase","description","uploader","matiere","code","pfeData","titreProjet","anneeDiplome","filiereDiplome","resume","motsCles","tag","index","tailleFichier","typeMime","onSubmit","placeholder","type","disabled","filter"],"sources":["/Users/brahimkhalilkhalef/Projects/ISIArchive/frontend/src/components/forms/DocumentViewModal.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n  X,\n  Download,\n  Eye,\n  FileText,\n  Calendar,\n  User,\n  MessageCircle,\n  Send,\n  Edit2,\n  Trash2,\n  Reply,\n  BookOpen,\n  GraduationCap,\n  Star,\n  FileIcon,\n  Loader2\n} from 'lucide-react';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { documentsAPI, commentsAPI } from '../../utils/api';\nimport { Document, Comment } from '../../types';\nimport toast from 'react-hot-toast';\n\ninterface DocumentViewModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  document: Document;\n  onDownload: () => void;\n}\n\nconst DocumentViewModal: React.FC<DocumentViewModalProps> = ({\n  isOpen,\n  onClose,\n  document,\n  onDownload\n}) => {\n  const { user } = useAuth();\n  const [comments, setComments] = useState<Comment[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [submitting, setSubmitting] = useState(false);\n  const [newComment, setNewComment] = useState('');\n  const [replyTo, setReplyTo] = useState<string | null>(null);\n  const [editingComment, setEditingComment] = useState<string | null>(null);\n  const [editContent, setEditContent] = useState('');\n\n  useEffect(() => {\n    if (isOpen && document) {\n      fetchComments();\n    }\n  }, [isOpen, document]);\n\n  const fetchComments = async () => {\n    try {\n      setLoading(true);\n      const response = await documentsAPI.getDocumentComments(document.id);\n      setComments(response.data);\n    } catch (error) {\n      console.error('Error fetching comments:', error);\n      toast.error('Erreur lors du chargement des commentaires');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSubmitComment = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newComment.trim()) return;\n\n    try {\n      setSubmitting(true);\n      await documentsAPI.createComment(document.id, {\n        contenu: newComment,\n        parentId: replyTo || undefined\n      });\n      \n      setNewComment('');\n      setReplyTo(null);\n      await fetchComments();\n      toast.success('Commentaire ajouté avec succès');\n    } catch (error) {\n      console.error('Error creating comment:', error);\n      toast.error('Erreur lors de l\\'ajout du commentaire');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const handleEditComment = async (commentId: string) => {\n    if (!editContent.trim()) return;\n\n    try {\n      await commentsAPI.updateComment(commentId, {\n        contenu: editContent\n      });\n      \n      setEditingComment(null);\n      setEditContent('');\n      await fetchComments();\n      toast.success('Commentaire modifié avec succès');\n    } catch (error) {\n      console.error('Error updating comment:', error);\n      toast.error('Erreur lors de la modification du commentaire');\n    }\n  };\n\n  const handleDeleteComment = async (commentId: string) => {\n    if (!window.confirm('Êtes-vous sûr de vouloir supprimer ce commentaire ?')) return;\n\n    try {\n      await commentsAPI.deleteComment(commentId);\n      await fetchComments();\n      toast.success('Commentaire supprimé avec succès');\n    } catch (error) {\n      console.error('Error deleting comment:', error);\n      toast.error('Erreur lors de la suppression du commentaire');\n    }\n  };\n\n  const startEdit = (comment: Comment) => {\n    setEditingComment(comment.id);\n    setEditContent(comment.contenu);\n  };\n\n  const cancelEdit = () => {\n    setEditingComment(null);\n    setEditContent('');\n  };\n\n  const formatFileSize = (bytes: string) => {\n    const size = parseInt(bytes);\n    if (size === 0) return '0 B';\n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(size) / Math.log(k));\n    return parseFloat((size / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  };\n\n  const getCategoryIcon = (categorie: string) => {\n    switch (categorie) {\n      case 'cours': return BookOpen;\n      case 'td': return FileText;\n      case 'tp': return FileIcon;\n      case 'examen': return Calendar;\n      case 'correction': return Star;\n      case 'pfe': return GraduationCap;\n      default: return FileText;\n    }\n  };\n\n  const getCategoryColor = (categorie: string) => {\n    switch (categorie) {\n      case 'cours': return 'bg-blue-100 text-blue-800';\n      case 'td': return 'bg-green-100 text-green-800';\n      case 'tp': return 'bg-purple-100 text-purple-800';\n      case 'examen': return 'bg-red-100 text-red-800';\n      case 'correction': return 'bg-yellow-100 text-yellow-800';\n      case 'pfe': return 'bg-indigo-100 text-indigo-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const canEditComment = (comment: Comment) => {\n    return user?.id === comment.auteurId || user?.role === 'admin';\n  };\n\n  const renderComment = (comment: Comment, isReply = false) => {\n    const isEditing = editingComment === comment.id;\n    \n    return (\n      <div key={comment.id} className={`${isReply ? 'ml-8 border-l-2 border-gray-200 pl-4' : ''}`}>\n        <div className=\"bg-gray-50 rounded-lg p-4 mb-4\">\n          <div className=\"flex items-start justify-between mb-2\">\n            <div className=\"flex items-center space-x-2\">\n              <div className=\"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center\">\n                <User className=\"w-4 h-4 text-primary-600\" />\n              </div>\n              <div>\n                <p className=\"text-sm font-medium text-gray-900\">\n                  {comment.auteur.prenom} {comment.auteur.nom}\n                </p>\n                <p className=\"text-xs text-gray-500\">\n                  {new Date(comment.createdAt).toLocaleDateString('fr-FR', {\n                    year: 'numeric',\n                    month: 'long',\n                    day: 'numeric',\n                    hour: '2-digit',\n                    minute: '2-digit'\n                  })}\n                </p>\n              </div>\n            </div>\n            \n            {canEditComment(comment) && (\n              <div className=\"flex items-center space-x-1\">\n                <button\n                  onClick={() => startEdit(comment)}\n                  className=\"p-1 text-gray-400 hover:text-gray-600\"\n                  title=\"Modifier\"\n                >\n                  <Edit2 className=\"w-4 h-4\" />\n                </button>\n                <button\n                  onClick={() => handleDeleteComment(comment.id)}\n                  className=\"p-1 text-gray-400 hover:text-red-600\"\n                  title=\"Supprimer\"\n                >\n                  <Trash2 className=\"w-4 h-4\" />\n                </button>\n              </div>\n            )}\n          </div>\n          \n          {isEditing ? (\n            <div className=\"space-y-2\">\n              <textarea\n                value={editContent}\n                onChange={(e) => setEditContent(e.target.value)}\n                className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                rows={3}\n              />\n              <div className=\"flex items-center space-x-2\">\n                <button\n                  onClick={() => handleEditComment(comment.id)}\n                  className=\"px-3 py-1 text-sm bg-primary-600 text-white rounded-md hover:bg-primary-700\"\n                >\n                  Sauvegarder\n                </button>\n                <button\n                  onClick={cancelEdit}\n                  className=\"px-3 py-1 text-sm bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400\"\n                >\n                  Annuler\n                </button>\n              </div>\n            </div>\n          ) : (\n            <>\n              <p className=\"text-gray-700 mb-2\">{comment.contenu}</p>\n              {!isReply && (\n                <button\n                  onClick={() => setReplyTo(comment.id)}\n                  className=\"text-sm text-primary-600 hover:text-primary-800 flex items-center space-x-1\"\n                >\n                  <Reply className=\"w-3 h-3\" />\n                  <span>Répondre</span>\n                </button>\n              )}\n            </>\n          )}\n        </div>\n        \n        {/* Render replies */}\n        {comment.reponses && comment.reponses.map(reply => renderComment(reply, true))}\n      </div>\n    );\n  };\n\n  const CategoryIcon = getCategoryIcon(document.categorie);\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <div className=\"fixed inset-0 z-50 overflow-y-auto\">\n          <div className=\"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0\">\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              className=\"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75\"\n              onClick={onClose}\n            />\n\n            <motion.div\n              initial={{ opacity: 0, scale: 0.95, y: 20 }}\n              animate={{ opacity: 1, scale: 1, y: 0 }}\n              exit={{ opacity: 0, scale: 0.95, y: 20 }}\n              className=\"inline-block w-full max-w-4xl p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg\"\n            >\n              <div className=\"flex items-center justify-between mb-6\">\n                <div className=\"flex items-center space-x-3\">\n                  <div className=\"p-2 bg-gray-100 rounded-lg\">\n                    <CategoryIcon className=\"w-6 h-6 text-gray-600\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-medium text-gray-900\">\n                      {document.titre}\n                    </h3>\n                    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getCategoryColor(document.categorie)}`}>\n                      {document.categorie.toUpperCase()}\n                    </span>\n                  </div>\n                </div>\n                <button\n                  onClick={onClose}\n                  className=\"p-2 text-gray-400 hover:text-gray-600 transition-colors\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </button>\n              </div>\n\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                {/* Document Details */}\n                <div className=\"space-y-4\">\n                  <div>\n                    <h4 className=\"text-sm font-medium text-gray-900 mb-2\">Description</h4>\n                    <p className=\"text-gray-700\">\n                      {document.description || 'Aucune description disponible.'}\n                    </p>\n                  </div>\n\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <h4 className=\"text-sm font-medium text-gray-900 mb-1\">Auteur</h4>\n                      <p className=\"text-gray-700\">\n                        {document.uploader.prenom} {document.uploader.nom}\n                      </p>\n                    </div>\n                    <div>\n                      <h4 className=\"text-sm font-medium text-gray-900 mb-1\">Date</h4>\n                      <p className=\"text-gray-700\">\n                        {new Date(document.createdAt).toLocaleDateString('fr-FR')}\n                      </p>\n                    </div>\n                  </div>\n\n                  {document.matiere && (\n                    <div>\n                      <h4 className=\"text-sm font-medium text-gray-900 mb-1\">Matière</h4>\n                      <p className=\"text-gray-700\">\n                        {document.matiere.nom} ({document.matiere.code})\n                      </p>\n                    </div>\n                  )}\n\n                  {document.pfeData && (\n                    <div className=\"space-y-2\">\n                      <div>\n                        <h4 className=\"text-sm font-medium text-gray-900 mb-1\">Projet PFE</h4>\n                        <p className=\"text-gray-700\">{document.pfeData.titreProjet}</p>\n                      </div>\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                          <h4 className=\"text-sm font-medium text-gray-900 mb-1\">Année</h4>\n                          <p className=\"text-gray-700\">{document.pfeData.anneeDiplome}</p>\n                        </div>\n                        <div>\n                          <h4 className=\"text-sm font-medium text-gray-900 mb-1\">Filière</h4>\n                          <p className=\"text-gray-700\">{document.pfeData.filiereDiplome}</p>\n                        </div>\n                      </div>\n                      {document.pfeData.resume && (\n                        <div>\n                          <h4 className=\"text-sm font-medium text-gray-900 mb-1\">Résumé</h4>\n                          <p className=\"text-gray-700\">{document.pfeData.resume}</p>\n                        </div>\n                      )}\n                      {document.pfeData.motsCles.length > 0 && (\n                        <div>\n                          <h4 className=\"text-sm font-medium text-gray-900 mb-1\">Mots-clés</h4>\n                          <div className=\"flex flex-wrap gap-1\">\n                            {document.pfeData.motsCles.map((tag, index) => (\n                              <span\n                                key={index}\n                                className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800\"\n                              >\n                                {tag}\n                              </span>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <h4 className=\"text-sm font-medium text-gray-900 mb-1\">Taille</h4>\n                      <p className=\"text-gray-700\">{formatFileSize(document.tailleFichier)}</p>\n                    </div>\n                    <div>\n                      <h4 className=\"text-sm font-medium text-gray-900 mb-1\">Type</h4>\n                      <p className=\"text-gray-700\">{document.typeMime}</p>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center space-x-3 pt-4\">\n                    <button\n                      onClick={onDownload}\n                      className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n                    >\n                      <Download className=\"w-4 h-4 mr-2\" />\n                      Télécharger\n                    </button>\n                  </div>\n                </div>\n\n                {/* Comments Section */}\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center space-x-2\">\n                    <MessageCircle className=\"w-5 h-5 text-gray-600\" />\n                    <h4 className=\"text-lg font-medium text-gray-900\">\n                      Commentaires ({comments.length})\n                    </h4>\n                  </div>\n\n                  {/* New Comment Form */}\n                  <form onSubmit={handleSubmitComment} className=\"space-y-3\">\n                    <textarea\n                      value={newComment}\n                      onChange={(e) => setNewComment(e.target.value)}\n                      placeholder={replyTo ? \"Écrire une réponse...\" : \"Ajouter un commentaire...\"}\n                      className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500\"\n                      rows={3}\n                    />\n                    <div className=\"flex items-center justify-between\">\n                      {replyTo && (\n                        <button\n                          type=\"button\"\n                          onClick={() => setReplyTo(null)}\n                          className=\"text-sm text-gray-500 hover:text-gray-700\"\n                        >\n                          Annuler la réponse\n                        </button>\n                      )}\n                      <button\n                        type=\"submit\"\n                        disabled={submitting || !newComment.trim()}\n                        className=\"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed ml-auto\"\n                      >\n                        {submitting ? (\n                          <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                        ) : (\n                          <Send className=\"w-4 h-4 mr-2\" />\n                        )}\n                        {replyTo ? 'Répondre' : 'Commenter'}\n                      </button>\n                    </div>\n                  </form>\n\n                  {/* Comments List */}\n                  <div className=\"max-h-96 overflow-y-auto space-y-4\">\n                    {loading ? (\n                      <div className=\"flex items-center justify-center py-8\">\n                        <Loader2 className=\"w-6 h-6 animate-spin text-primary-600\" />\n                      </div>\n                    ) : comments.length === 0 ? (\n                      <div className=\"text-center py-8\">\n                        <MessageCircle className=\"mx-auto h-8 w-8 text-gray-400\" />\n                        <p className=\"mt-2 text-sm text-gray-500\">\n                          Aucun commentaire pour le moment.\n                        </p>\n                      </div>\n                    ) : (\n                      comments\n                        .filter(comment => !comment.parentId) // Only show top-level comments\n                        .map(comment => renderComment(comment))\n                    )}\n                  </div>\n                </div>\n              </div>\n            </motion.div>\n          </div>\n        </div>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default DocumentViewModal; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}