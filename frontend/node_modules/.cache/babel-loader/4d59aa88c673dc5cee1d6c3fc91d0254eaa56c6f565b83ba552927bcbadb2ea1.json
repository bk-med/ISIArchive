{"ast":null,"code":"import React from'react';import{Navigate,useLocation}from'react-router-dom';import{motion}from'framer-motion';import{useAuth}from'../../contexts/AuthContext';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children,roles=[],requireAuth=true}=_ref;const{user,isAuthenticated,isLoading}=useAuth();const location=useLocation();// Show loading spinner while checking authentication\nif(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-secondary-50\",children:/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,scale:0.8},animate:{opacity:1,scale:1},transition:{duration:0.3},className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-secondary-600\",children:\"V\\xE9rification de l'authentification...\"})]})});}// Redirect to login if authentication is required but user is not authenticated\nif(requireAuth&&!isAuthenticated){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",state:{from:location},replace:true});}// Redirect to dashboard if user is authenticated but trying to access login page\nif(!requireAuth&&isAuthenticated){return/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true});}// Check role-based access\nif(requireAuth&&isAuthenticated&&roles.length>0){if(!user||!roles.includes(user.role)){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-secondary-50\",children:/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.5},className:\"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-6\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-8 h-8 text-red-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z\"})})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-secondary-900 mb-2\",children:\"Acc\\xE8s non autoris\\xE9\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-secondary-600 mb-6\",children:\"Vous n'avez pas les permissions n\\xE9cessaires pour acc\\xE9der \\xE0 cette page.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.history.back(),className:\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\",children:\"Retour\"})]})});}}return/*#__PURE__*/_jsx(_Fragment,{children:children});};export default ProtectedRoute;","map":{"version":3,"names":["React","Navigate","useLocation","motion","useAuth","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ProtectedRoute","_ref","children","roles","requireAuth","user","isAuthenticated","isLoading","location","className","div","initial","opacity","scale","animate","transition","duration","to","state","from","replace","length","includes","role","y","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","onClick","window","history","back"],"sources":["/Users/brahimkhalilkhalef/Projects/ISIArchive/frontend/src/components/auth/ProtectedRoute.tsx"],"sourcesContent":["import React from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport { useAuth } from '../../contexts/AuthContext';\n\ninterface ProtectedRouteProps {\n  children: React.ReactNode;\n  roles?: string[];\n  requireAuth?: boolean;\n}\n\nconst ProtectedRoute: React.FC<ProtectedRouteProps> = ({\n  children,\n  roles = [],\n  requireAuth = true,\n}) => {\n  const { user, isAuthenticated, isLoading } = useAuth();\n  const location = useLocation();\n\n  // Show loading spinner while checking authentication\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-secondary-50\">\n        <motion.div\n          initial={{ opacity: 0, scale: 0.8 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ duration: 0.3 }}\n          className=\"text-center\"\n        >\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4\"></div>\n          <p className=\"text-secondary-600\">Vérification de l'authentification...</p>\n        </motion.div>\n      </div>\n    );\n  }\n\n  // Redirect to login if authentication is required but user is not authenticated\n  if (requireAuth && !isAuthenticated) {\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  // Redirect to dashboard if user is authenticated but trying to access login page\n  if (!requireAuth && isAuthenticated) {\n    return <Navigate to=\"/dashboard\" replace />;\n  }\n\n  // Check role-based access\n  if (requireAuth && isAuthenticated && roles.length > 0) {\n    if (!user || !roles.includes(user.role)) {\n      return (\n        <div className=\"min-h-screen flex items-center justify-center bg-secondary-50\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center\"\n          >\n            <div className=\"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-6\">\n              <svg\n                className=\"w-8 h-8 text-red-600\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z\"\n                />\n              </svg>\n            </div>\n            \n            <h2 className=\"text-xl font-bold text-secondary-900 mb-2\">\n              Accès non autorisé\n            </h2>\n            <p className=\"text-secondary-600 mb-6\">\n              Vous n'avez pas les permissions nécessaires pour accéder à cette page.\n            </p>\n            \n            <button\n              onClick={() => window.history.back()}\n              className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n            >\n              Retour\n            </button>\n          </motion.div>\n        </div>\n      );\n    }\n  }\n\n  return <>{children}</>;\n};\n\nexport default ProtectedRoute; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}